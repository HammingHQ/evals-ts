{"version":3,"sources":["../src/prompt-template.ts"],"sourcesContent":["import { ChatMessage, PromptContent } from \"./types\";\n\nexport class PromptTemplate {\n  readonly prompt: PromptContent;\n  readonly vars: Array<string>;\n\n  constructor(prompt: PromptContent) {\n    this.prompt = prompt;\n    this.vars = this.extractVariables(prompt.chatMessages ?? []);\n  }\n\n  private extractVariables(messages: ChatMessage[]): string[] {\n    const content = messages.map((message) => message.content).join(\"\\n\\n\");\n    const matches = content.match(/\\{\\{([^}]+)\\}\\}/g) ?? [];\n    return matches.map((match) => match.replace(/\\{\\{([^}]+)\\}\\}/g, \"$1\"));\n  }\n\n  compile(values: Record<string, string>): PromptContent {\n    return {\n      ...this.prompt,\n      chatMessages: this.prompt.chatMessages.map((message) => {\n        return {\n          ...message,\n          content: message.content.replace(\n            /\\{\\{([^}]+)\\}\\}/g,\n            (match, pattern) => {\n              return values[pattern] || match;\n            },\n          ),\n        };\n      }),\n    };\n  }\n}\n"],"mappings":"wCAEO,IAAMA,EAAN,KAAqB,CAI1B,YAAYC,EAAuB,CAHnCC,EAAA,KAAS,UACTA,EAAA,KAAS,QAGP,KAAK,OAASD,EACd,KAAK,KAAO,KAAK,iBAAiBA,EAAO,cAAgB,CAAC,CAAC,CAC7D,CAEQ,iBAAiBE,EAAmC,CAG1D,OAFgBA,EAAS,IAAKC,GAAYA,EAAQ,OAAO,EAAE,KAAK;AAAA;AAAA,CAAM,EAC9C,MAAM,kBAAkB,GAAK,CAAC,GACvC,IAAKC,GAAUA,EAAM,QAAQ,mBAAoB,IAAI,CAAC,CACvE,CAEA,QAAQC,EAA+C,CACrD,MAAO,CACL,GAAG,KAAK,OACR,aAAc,KAAK,OAAO,aAAa,IAAKF,IACnC,CACL,GAAGA,EACH,QAASA,EAAQ,QAAQ,QACvB,mBACA,CAACC,EAAOE,IACCD,EAAOC,CAAO,GAAKF,CAE9B,CACF,EACD,CACH,CACF,CACF","names":["PromptTemplate","prompt","__publicField","messages","message","match","values","pattern"]}