var h=Object.defineProperty;var p=(i,e,t)=>e in i?h(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var E=(i,e,t)=>(p(i,typeof e!="symbol"?e+"":e,t),t);var l=class{constructor(e){E(this,"apiKey");E(this,"baseURL");this.apiKey=e.apiKey,this.baseURL=this.sanitizeBaseUrl(e.baseURL)}sanitizeBaseUrl(e){return e.trim().replace(/\/$/,"")}async fetch(e,t,s=3,n=1e3){let r=this.baseURL+e,R=null,o=n;for(let c=0;c<s;c++)try{let a=await this.attemptFetch(r,t);if(a.ok)return a;let u=this.generateErrorMessage(a,r);if(R=new Error(u),this.nonTransientError(a))break;if(this.shouldRetry(a))await this.waitForRetry(a,o),o*=2;else throw new Error(u)}catch(a){if(R=a,!this.isNetworkError(a))break;await this.delay(o),o*=2}throw R}nonTransientError(e){return[401,403,404,400].includes(e.status)}delay(e){return new Promise(t=>setTimeout(t,e))}shouldRetry(e){return e.status===429||e.status>=500}isNetworkError(e){return e instanceof TypeError}generateErrorMessage(e,t){let s=e.status,n=e.statusText,r=`Request failed with status ${s} ${n} while accessing ${t}.`;return s===401?r=`UNAUTHORIZED: Invalid API key ending in '${this.apiKey.slice(-4)}'. Visit https://app.hamming.ai/settings to see valid API keys.`:s===403?r=`FORBIDDEN: You do not have permission to access ${t}.`:s===404?r=`NOT FOUND: The requested resource at ${t} could not be found.`:s===429?r="TOO MANY REQUESTS: You are being rate limited. Please wait before making additional requests. If the issue persists, feel free to email us at founders@hamming.ai for help.":s>=500&&(r=`SERVER ERROR: There was a problem with the server while accessing ${t}. If the issue persists, feel free to email us at founders@hamming.ai for help.`),r}async attemptFetch(e,t){let s=this.createHeaders(t?.headers);return await fetch(e,{...t,headers:s})}createHeaders(e){let t={...e,authorization:`Bearer ${this.apiKey}`};return(!e||!("content-type"in e))&&(t["content-type"]="application/json"),t}async waitForRetry(e,t){let s=e.headers.get("Retry-After"),n=s?this.calculateRetryDelayForHeaders(s,t):t;await this.delay(n)}calculateRetryDelayForHeaders(e,t){if(parseInt(e,10))return parseInt(e,10)*1e3;let s=new Date(e);return isNaN(s.getTime())?t:s.getTime()-Date.now()}};export{E as a,l as b};
//# sourceMappingURL=chunk-K2DRTD63.js.map